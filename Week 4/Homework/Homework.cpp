//P04:
/*	
	25125043
	Nguyen Quang Hieu
	25A01
    Test case 1:
        Input: 4
			   25 12 50 43
        Output: 43

    Test case 2:
        Input: 3
			   251 2 5043	
        Output: 251 2
		
    Test case 3:
        Input: 5
			   2 6 1 4 7
        Output: 2 7
*/

//P08:
/*	
	25125043
	Nguyen Quang Hieu
	25A01
    Test case 1:
        Input: 7 3 2
			   12 67 45 87 678 0 2
        Output: 12 67 45 0 2

    Test case 2:
        Input: 7 2 1
			   12 67 45 87 678 0 2
        Output: 12 67 87 678 0 2
		
    Test case 3:
        Input: 10 3 4
			   9 18 76 87 54 65 67 34 23 21
        Output: 9 18 76 34 23 21
*/

//P12:
/*	
	25125043
	Nguyen Quang Hieu
	25A01
    Test case 1:
        Input: 7
			   5 12 5 45 87 678 5 
        Output: 87

    Test case 2:
        Input: 4
			   2 5 1 2	
        Output: 2
		
    Test case 3:
        Input: 4
			   25 12 50 43
        Output: 43
*/

//P26:
/*	
	25125043
	Nguyen Quang Hieu
	25A01
    Test case 1:
        Input: 7 6
			   3 5 12 67 80 45 678 5 23 12 45 56 67 
        Output: 5 12 67 45 

    Test case 2:
        Input: 7 6
			   3 5 12 67 67 45 678 5 23 12 45 12 67 	
        Output: 5 12 12 67 67 45
		
    Test case 3:
        Input: 4 4
			   2 5 1 2 5 0 4 3
        Output: 5
*/

//P322:
/*	
	25125043
	Nguyen Quang Hieu
	25A01
    Test case 1:
        Input: 4 4
			   2 5 1 2
			   5 0 4 3
			   25 12 50 43
			   2 51 250 43
        Output: 10 12 130 346

    Test case 2:
        Input: 3 8
			   2 5 1 2 5 0 4 3
			   25 12 50 43 34 05 21 52
			   2 51 25 04 3 251 250 43
        Output: 22 242 629
		
    Test case 3:
        Input: 1 8
			   2 5 1 2 5 0 4 3
        Output: 22
*/

//P347:
/*	
	25125043
	Nguyen Quang Hieu
	25A01
    Test case 1:
        Input: 4 4
			   2 5 1 2
			   5 0 4 3
			   25 12 50 43
			   2 51 250 43
        Output: 0

    Test case 2:
        Input: 3 8
			   2 5 1 2 5 0 4 3
			   25 12 50 43 34 05 21 52
			   2 51 25 04 3 251 250 43
        Output: 1
		
    Test case 3:
        Input: 1 8
			   2 5 1 2 5 0 4 3
        Output: 2
*/

//P398:
/*	
	25125043
	Nguyen Quang Hieu
	25A01
    Test case 1:
        Input: 4 4
			   2 5 1 2
			   5 0 4 3
			   25 12 50 43
			   2 51 250 43
        Output: 5 2 5 1 
				25 0 4 2 
				2 12 50 3 
				51 250 43 43

    Test case 2:
        Input: 3 8
			   2 5 1 2 5 0 4 3
			   25 12 50 43 34 05 21 52
			   2 51 25 04 3 251 250 43
        Output: 25 2 5 1 2 5 0 4
				2 12 50 43 34 5 21 3
				51 25 4 3 251 250 43 52
		
    Test case 3:
        Input: 2 8
			   2 5 1 2 5 0 4 3
			   25 12 50 43 34 05 21 52
        Output: 25 2 5 1 2 5 0 4
				12 50 43 34 5 21 52 3 
*/

//P423:
/*	
	25125043
	Nguyen Quang Hieu
	25A01
    Test case 1:
        Input: 4 4
			   2 5 1 2
			   5 0 4 3
			   25 12 50 43
			   2 51 250 43
        Output: 0 1 2 2
				43 43 50 2
				25 250 51 3 
				12 5 5 4

    Test case 2:
        Input: 3 8
			   2 5 1 2 5 0 4 3
			   25 12 50 43 34 05 21 52
			   2 51 25 04 3 251 250 43
        Output: 0 1 2 2 2 3 3 4
				43 43 50 51 52 250 251 4
				34 25 25 21 12 5 5 5
		
    Test case 3:
        Input: 2 8
			   2 5 1 2 5 0 4 3
			   25 12 50 43 34 05 21 52
        Output: 0 1 2 2 3 4 5 5
				52 50 43 34 25 21 12 5
*/

//P457:
/*	
	25125043
	Nguyen Quang Hieu
	25A01
    Test case 1:
        Input: 4 4
			   2 5 1 2
			   5 0 4 3
			   25 12 50 43
			   2 51 250 43
        Output: Matrix is not symmetrical.

    Test case 2:
        Input: 3 8
        Output: Matrix is not symmetrical.
		
    Test case 3:
        Input: 4 4
			   0 2 5 1
			   2 1 2 5
			   5 2 2 0
			   1 5 0 4
        Output: Matrix is symmetrical in respect to the main diagonal.
*/

//P471:
/*	
	25125043
	Nguyen Quang Hieu
	25A01
    Test case 1:
		Input: 4 4 
			   2 5 1 2
			   5 0 4 3
			   25 12 50 43
			   2 51 250 43
			   4 8
			   3 4 0 5 2 1 5 2
			   2 5 1 2 5 0 4 3
			   25 12 50 43 34 05 21 52
			   2 51 25 04 3 251 250 43
		Output: 45 147 105 71 69 509 551 157 
				121 221 275 209 155 778 859 347 
				1435 2953 3587 2471 1939 11068 11973 4535
				6444 5456 13626 11034 8888 12045 16214 15006

    Test case 2:
        Input: 4 4 
			   2 5 1 2
			   5 0 4 3
			   25 12 50 43
			   2 51 250 43 
			   1 8
			   2 5 1 2 5 0 4 3
        Output: Unable to calculate the product of the two matrices.
		
    Test case 3:
        Input: 3 8 
			   2 5 1 2 5 0 4 3
			   25 12 50 43 34 05 21 52
			   2 51 25 04 3 251 250 43 
			   8 1
			   2 
			   5 
			   1 
			   2 
			   5 
			   0 
			   4 
			   3
        Output: 84 
				656
				1436
*/


#include <iostream>
#include <cmath>
#include <vector>
#include <climits>

int main() {
    int choice;
    std::cout << "Select an option (1-10): ";
    std::cin >> choice;
    if (choice < 1 || choice > 10) {
        std::cout << "Invalid choice. Please select a number between 1 and 10.";
        return 0;
    }
    else if (choice == 1) {
        std::cout << "Proceed with P04 problem." << std::endl;
        int n;
        std::cout << "Enter a positive integer (1-100) as array's length: ";
        std::cin >> n;
        if (n < 1 || n > 100) {
            std::cout << "Try again for valid number(s).";
            return 0;
        }
        std::cout << "Please enter array elements one by one: ";
        std::vector<int> ar(n);
        for (int i = 0; i < n; i++) {
            std::cin >> ar[i];
        }
        std::cout << "Prime number found (if there are any): ";
        for (int x : ar) {
            if(x % 2 == 0 && x > 2) {
                continue;
            }
            else if (x < 2) {
                continue;
            }
            else {
                bool isp = false;
                for (int i = 3; i <= sqrt(x); i++){
                    if (x % i == 0) {
                        isp = true;
                        break;
                    }
                }
                if (isp) continue;
                else std::cout << x << ' ';
            }
        }
    }
    else if (choice == 2) {
        std::cout << "Proceed with P08 problem." << std::endl;
        int n, m, p, c;
        std::cout << "Enter a positive integer as array's length: ";
        std::cin >> n;
        std::cout << "Please enter starting index number: ";
        std::cin >> m;
        std::cout << "Please enter number of input to be deleted: ";
        std::cin >> p;
        std::cout << "Please enter array elements one by one: ";
        std::vector<int> ar;
        for (int i = 0; i < n; i++) {
            std::cin >> c;
            ar.push_back(c);
        }
        ar.erase(ar.begin() + m, ar.begin() + m + p);
        std::cout << "Array after process: ";
        for (int x : ar) {
            std::cout << x << ' ';
        }
    }
    else if (choice == 3) {
        std::cout << "Proceed with P12 problem." << std::endl;
        int n, max, max2;
        std::cout << "Enter a positive integer: ";
        std::cin >> n;
        if (n < 2) {
            std::cout << "Try again for valid number(s) (>=2).";
            return 0;
        }
        std::cout << "Please enter array elements one by one: ";
        int ar[n];
        std::cin >> ar[0];
        max = ar[0];
        max2 = max + 1;
        for (int i = 1; i < n; i++) {
            std::cin >> ar[i];
            if (ar[i] > max) {
                max2 = max;
                max = ar[i];
            }
            if (ar[i] < max && ar[i] > max2) max2 = ar[i];
        }
        if (max2 == max + 1) {
            std::cout << "There is no second largest number.";
            return 0;
        }
        std::cout << "The second largest number is: " << max2;
    }
    else if (choice == 4) {
        std::cout << "Proceed with P26 problem." << std::endl;
        int n, m;
        std::cout << "Enter a positive integer as the first array's length: ";
        std::cin >> n;
        std::cout << "Enter a positive integer as the second array's length: ";
        std::cin >> m;
        std::cout << "Please enter first array's elements one by one: ";
        int ar[n], br[m];
        for (int i = 0; i < n; i++) {
            std::cin >> ar[i];
        }
        std::cout << "Please enter second array's elements one by one: ";
        for (int i = 0; i < m; i++) {
            std::cin >> br[i];
        }
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < m; j++) {
                if (ar[i] == br[j]) {
                    std::cout << ar[i] << ' ';
                }
            }
        }
    }
    else if (choice == 5) {
        std::cout << "Proceed with P322 problem." << std::endl;
        int n, m;
        std::cout << "Enter a positive integer as number of rows: ";
        std::cin >> n;
        std::cout << "Enter a positive integer as number of columns: ";
        std::cin >> m;
        std::cout << "Please enter array elements one by one: " << '\n';
        int ar[n][m], sum[n];
        for (int i = 0; i < n; i++) {
            sum[i] = 0;
            std::cout << i << ": ";
            for (int j = 0; j < m; j++) {
                std::cin >> ar[i][j];
                sum[i] += ar[i][j];
            }
        }
        for (int i = 0; i < n; i++) {
            std::cout << "sum of values in row index " << i << " is " << sum[i] << '\n';
        }
    }
    else if (choice == 6) {
        std::cout << "Proceed with P347 problem." << std::endl;
        int n, m;
        std::cout << "Enter a positive integer as number of rows: ";
        std::cin >> n;
        std::cout << "Enter a positive integer as number of columns: ";
        std::cin >> m;
        std::cout << "Please enter array elements one by one: " << '\n';
        int ar[n][m], saddle = 0, max, check[m], count = 0;
        for (int i = 0; i < n; i++) {
            std::cout << i << ": ";
            for (int j = 0; j < m; j++) {
                std::cin >> ar[i][j];
            }
        }
        for (int j = 0; j < m; j++) {
            check[j] = 0;
        }
        for (int i = 0; i < n; i++) {
            max = INT_MIN;
            count = 0;
            for (int j = 0; j < m; j++) {
                if (ar[i][j] >= max) {
                    max = ar[i][j];
                    check[count] = j;
                    count ++;
                }
            }
            for (int j = 0; j < count; j++) {
                for (int k = 0; k < n; k++) {
                    if (ar[k][check[j]] < max) {
                        break;
                    }
                    if (k == n - 1 && ar[n - 1][check[j]] >= max) {
                        saddle += 1;
                    }
                }
            }
        }
        std::cout << "Number of saddle points: " << saddle;
    }
    else if (choice == 7) {
        std::cout << "Proceed with P398 problem." << std::endl;
        int n, m;
        std::cout << "Enter a positive integer as number of rows: ";
        std::cin >> n;
        std::cout << "Enter a positive integer as number of columns: ";
        std::cin >> m;
        std::cout << "Please enter array elements one by one: " << '\n';
        int ar[n][m], br[n][m];
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < m; j++) {
                std::cin >> ar[i][j];
            }
        }
        for (int i = 1; i < n - 1; i++) {
            for (int j = 1; j < m - 1; j++) {
                br[i][j] = ar[i][j];
            }
        }
        for (int j = 1; j < m; j++) {
            br[0][j] = ar[0][j - 1];
            br[n-1][m - 1 - j] = ar[n-1][m - j];
        }
        for (int j = 1; j < n; j++) {
            br[n - 1 - j][0] = ar[n - j][0];
            br[j][m - 1] = ar[j - 1][m - 1];
        }
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < m; j++) {
                std::cout << br[i][j] << ' ';
            }
            std::cout << '\n';
        }
    }
    else if (choice == 8) {
        std::cout << "Proceed with P423 problem." << std::endl;
        int n, m;
        std::cout << "Enter a positive integer as number of rows: ";
        std::cin >> n;
        std::cout << "Enter a positive integer as number of columns: ";
        std::cin >> m;
        std::cout << "Please enter array elements one by one: " << '\n';
        int ar[n][m], br[n][m], cr[n*m], min = INT_MAX, k = 0, a, b;
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < m; j++) {
                std::cin >> ar[i][j];
            }
        }
        for (int l = 0; l < n*m; l++) {
            for (int i = 0; i < n; i++) {
                for (int j = 0; j < m; j++) {
                    if (ar[i][j] <= min) {
                        min = ar[i][j];
                        a = i;
                        b = j;
                    }
                }
            }
            cr[l] = min;
            min = INT_MAX;
            ar[a][b] = INT_MAX;
        }
        for (int i = 0; i < (n + 1)/2; i++) {
            for (int j = i; j < m - i && k < n*m; j++) {
                br[i][j] = cr[k];
                k++;
            }
            for (int j = i + 1; j < n - i && k < n*m; j++) {
                br[j][m - i - 1] = cr[k];
                k++;
            }
            for (int j = m - i - 2; j >= i && k < n*m; j--) {
                    br[n - i - 1][j] = cr[k];
                k++;
            }
            for (int j = n - i - 2; j > i && k < n*m; j--) {
                br[j][i] = cr[k];
                k++;
            }
        }
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < m; j++) {
                std::cout << br[i][j] << ' ';
            }
            std::cout << '\n';
        }
    }
    else if (choice == 9) {
        std::cout << "Proceed with P457 problem." << std::endl;
        int n, m;
        std::cout << "Enter a positive integer as number of rows: ";
        std::cin >> n;
        std::cout << "Enter a positive integer as number of columns: ";
        std::cin >> m;
        if (n != m) {
            std::cout << "Matrix is not symmetrical.";
            return 0;
        }
        std::cout << "Please enter array elements one by one: " << '\n';
        int ar[n][m];
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < m; j++) {
                std::cin >> ar[i][j];
            }
        }
        for (int i = 0; i < n - 1; i++) {
            for (int j = i + 1; j < m; j++) {
                if (ar[i][j] != ar[j][i]) {
                    std::cout << "Matrix is not symmetrical.";
                    return 0;
                }
            }
        }
        std::cout << "Matrix is symmetrical in respect to the main diagonal.";
    }
    else if (choice == 10) {
        std::cout << "Proceed with P471 problem." << std::endl;
        int n, m, p, q;
        std::cout << "Enter a positive integer as number of rows of the first array: ";
        std::cin >> n;
        std::cout << "Enter a positive integer as number of columns of the first array: ";
        std::cin >> m;
        std::cout << "Please enter array elements one by one: " << '\n';
        int ar[n][m];
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < m; j++) {
                std::cin >> ar[i][j];
            }
        }
        std::cout << "Enter a positive integer as number of rows of the second array: ";
        std::cin >> p;
        std::cout << "Enter a positive integer as number of columns of the second array: ";
        std::cin >> q;
        if (m != p) {
            std::cout << "Unable to calculate the product of the two matrices.";
            return 0;
        }
        std::cout << "Please enter array elements one by one: " << '\n';
        int br[p][q], cr[n][q];
        for (int i = 0; i < p; i++) {
            for (int j = 0; j < q; j++) {
                std::cin >> br[i][j];
            }
        }
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < q; j++) {
                cr[i][j] = 0;
                for (int k = 0; k < p; k++) {
                    cr[i][j] += ar[i][k] * br[k][j];
                }
            }
        }
        for (int i = 0; i < n; i++) {
            for (int j = 0; j < q; j++) {
                std::cout << cr[i][j] << ' ';
            }
            std::cout << '\n';
        }
    }
    
    return 0;
}